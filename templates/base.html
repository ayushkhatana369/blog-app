<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}My Blog{% endblock %}</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <script>
        if (localStorage.getItem("theme") === "dark") {
            document.addEventListener("DOMContentLoaded", () => {
                document.body.classList.add("dark");
            });
        }
    </script>
</head>

<body>

<header>
    <div class="nav-container">

        <h1>
            <a href="{{ url_for('index') }}">My Blog</a>
        </h1>

        <!-- ðŸ” SEARCH (NOW INSIDE NAVBAR) -->
        <form
            action="{{ url_for('search') }}"
            method="get"
            class="nav-search"
        >
            <input
                type="text"
                name="q"
                placeholder="Search..."
                value="{{ request.args.get('q', '') }}"
            >
        </form>

        <nav>
            <a href="{{ url_for('index') }}">Home</a>

            {% if current_user.is_authenticated %}
                <a href="{{ url_for('write_post') }}">Write</a>

                <a href="{{ url_for('logout') }}">Logout</a>
            {% else %}
                <a href="{{ url_for('login') }}">Login</a>
            {% endif %}

            <button id="theme-toggle" type="button">ðŸŒ™</button>
        </nav>

    </div>
</header>


<main>
    {% block content %}{% endblock %}
</main>

<footer>
    <p>Â© {{ current_year }} My Blog</p>
</footer>

<script>
    const toggle = document.getElementById("theme-toggle");

    function setTheme(theme) {
        if (theme === "dark") {
            document.body.classList.add("dark");
            localStorage.setItem("theme", "dark");
            toggle.textContent = "â˜€ï¸";
        } else {
            document.body.classList.remove("dark");
            localStorage.setItem("theme", "light");
            toggle.textContent = "ðŸŒ™";
        }
    }

    setTheme(localStorage.getItem("theme") || "light");

    toggle.addEventListener("click", () => {
        const current = localStorage.getItem("theme") || "light";
        setTheme(current === "dark" ? "light" : "dark");
    });
</script>

</body>
</html>
